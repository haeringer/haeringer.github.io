<!doctype html>
<html lang="">	
<head>
	<meta charset="utf-8"/>
	<title>IP Tables Basics - kb</title>	
	<meta name="author" content="ben">
	

	<meta name="description" content="Here's a short reference on the basic configuration of an IP Tables firewall on Debian Linux. This assumes basic knowledge in firewalls. As with access lists in general, the order of the statements is important and IP Tables processes them from top to bottom. If unsure with the commands ...">


	<link rel="top" href="#" /><link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,300italic,400italic,600italic|Source+Code+Pro' rel='stylesheet' type='text/css'></link>
	<link rel="stylesheet" href="/theme/css/main.css" type="text/css" />
		

</head>
	
<body>

    <div class="container">
	  
	  <header role="banner">
	    <div class="feeds">
	    </div>
		<a href="" class="title">kb</a>
      </header>
	
	  <div class="wrapper">

		  <div role="main" class="content">
	<article class="full">
			
		<h1>IP Tables Basics</h1>
		
<div class="metadata">
  <time datetime="2012-04-17T15:22:00" pubdate>Di 17 April 2012</time>
    <address class="vcard author">
      by <a class="url fn" href="/author/ben.html">ben</a>
    </address>
  in <a href="/category/linux-networking.html">Linux, Networking</a>
<p class="tags">tagged <a href="/tag/command-reference.html">Command reference</a>, <a href="/tag/linux-networking.html">Linux networking</a></p></div>		
		<p>Here's a short reference on the basic configuration of an IP Tables
firewall on Debian Linux.</p>
<p>This assumes basic knowledge in firewalls. As with access lists in
general, the order of the statements is important and IP Tables
processes them from top to bottom.</p>
<p>If unsure with the commands and if you only have access to the server
over network, use a method to avoid locking you out of the system like
described in an <a href="http://kb.haeringer.org/define-commands-for-later-execution-auto-restore-backup-configurations/" title="Define commands for later execution / auto-restore backup configurations">earlier post</a>.<br />
</p>
<p>List existing rules:</p>
<div class="highlight"><pre><span class="n">iptables</span> <span class="o">-</span><span class="n">L</span> <span class="p">(</span><span class="o">-</span><span class="n">v</span><span class="p">)</span>
</pre></div>


<p>Allow established connections (stateful firewall operation): <!--more--></p>
<div class="highlight"><pre><span class="n">iptables</span> <span class="o">-</span><span class="n">A</span> <span class="n">INPUT</span> <span class="o">-</span><span class="n">m</span> <span class="n">conntrack</span> <span class="o">--</span><span class="n">ctstate</span> <span class="n">ESTABLISHED</span><span class="p">,</span><span class="n">RELATED</span> <span class="o">-</span><span class="n">j</span> <span class="n">ACCEPT</span>
<span class="p">(</span><span class="k">if</span> <span class="n">the</span> <span class="n">above</span> <span class="n">doesn</span><span class="err">&#39;</span><span class="n">t</span> <span class="n">work</span><span class="o">:</span><span class="p">)</span>
<span class="n">iptables</span> <span class="o">-</span><span class="n">A</span> <span class="n">INPUT</span> <span class="o">-</span><span class="n">m</span> <span class="n">state</span> <span class="o">--</span><span class="n">state</span> <span class="n">ESTABLISHED</span><span class="p">,</span><span class="n">RELATED</span> <span class="o">-</span><span class="n">j</span> <span class="n">ACCEPT</span>
</pre></div>


<p>Allow SSH from specific sources and HTTP from everywhere:</p>
<div class="highlight"><pre><span class="n">iptables</span> <span class="o">-</span><span class="n">A</span> <span class="n">INPUT</span> <span class="o">-</span><span class="n">s</span> <span class="mf">70.80.90.100</span> <span class="o">-</span><span class="n">p</span> <span class="n">tcp</span> <span class="o">--</span><span class="n">dport</span> <span class="n">ssh</span> <span class="o">-</span><span class="n">j</span> <span class="n">ACCEPT</span>
<span class="n">iptables</span> <span class="o">-</span><span class="n">A</span> <span class="n">INPUT</span> <span class="o">-</span><span class="n">s</span> <span class="mf">80.90.100.0</span><span class="o">/</span><span class="mi">23</span> <span class="o">-</span><span class="n">p</span> <span class="n">tcp</span> <span class="o">--</span><span class="n">dport</span> <span class="n">ssh</span> <span class="o">-</span><span class="n">j</span> <span class="n">ACCEPT</span>
<span class="n">iptables</span> <span class="o">-</span><span class="n">A</span> <span class="n">INPUT</span> <span class="o">-</span><span class="n">p</span> <span class="n">tcp</span> <span class="o">--</span><span class="n">dport</span> <span class="mi">80</span> <span class="o">-</span><span class="n">j</span> <span class="n">ACCEPT</span>
</pre></div>


<p>Block everything:</p>
<div class="highlight"><pre><span class="n">iptables</span> <span class="o">-</span><span class="n">A</span> <span class="n">INPUT</span> <span class="o">-</span><span class="n">j</span> <span class="n">DROP</span>
</pre></div>


<p>Insert rule on the first line to accept traffic on loopback interface:</p>
<div class="highlight"><pre><span class="n">iptables</span> <span class="o">-</span><span class="n">I</span> <span class="n">INPUT</span> <span class="mi">1</span> <span class="o">-</span><span class="n">i</span> <span class="n">lo</span> <span class="o">-</span><span class="n">j</span> <span class="n">ACCEPT</span>
</pre></div>


<p>Save IP Tables to keep the configuration at reboot:</p>
<div class="highlight"><pre><span class="n">iptables</span><span class="o">-</span><span class="n">save</span>
</pre></div>	

	</article>

    <p>
	<a href="https://twitter.com/share" class="twitter-share-button" data-via="" data-lang="en" data-size="large" data-related="">Tweet</a>
	<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
	</p>


		  </div>	
		  
		  <div class="sidebar">

	        <nav>
	          <h2>Categories</h2>
	          <ul>
	              <li ><a href="/category/cisco.html">Cisco</a></li>
	              <li ><a href="/category/linux.html">Linux</a></li>
	              <li class="active"><a href="/category/linux-networking.html">Linux, Networking</a></li>
	              <li ><a href="/category/linux-networking-windows.html">Linux, Networking, Windows</a></li>
	              <li ><a href="/category/linux-virtualization.html">Linux, Virtualization</a></li>
	              <li ><a href="/category/networking.html">Networking</a></li>
	              <li ><a href="/category/virtualization.html">Virtualization</a></li>
	              <li ><a href="/category/windows.html">Windows</a></li>
	          </ul>
	        </nav>



		  </div>

	  </div>

      <footer>
		<p role="contentinfo">
		  © 2013 ben - Proudly powered by <a href="http://alexis.notmyidea.org/pelican/">pelican</a>. Theme <a href="https://github.com/fle/pelican-simplegrey">pelican-simplegrey</a>.
    	</p>

	  </footer>	

	</div>
	

</body>
</html>